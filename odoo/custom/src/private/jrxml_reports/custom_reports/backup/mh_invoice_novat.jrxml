<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Invoice Form" language="groovy" pageWidth="612" pageHeight="775" columnWidth="602" leftMargin="5" rightMargin="5" topMargin="5" bottomMargin="5">
	<property name="ireport.layers" value="##Fri Aug 06 11:09:44 ICT 2010\nlayer.1.name=Invoice BG\nlayer.1.visible=true\nlayer.1.id=1\nlayer.0.name=Background\nlayer.0.visible=true\nlayer.0.id=0"/>
	<property name="ireport.zoom" value="1.3310000000000055"/>
	<property name="ireport.x" value="7"/>
	<property name="ireport.y" value="578"/>
	<property name="OPENERP_RELATIONS" value="[&quot;invoice_line&quot;]"/>
	<queryString language="xPath">
		<![CDATA[/data/record]]>
	</queryString>
	<field name="Total-amount_total" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[Total-amount_total]]></fieldDescription>
	</field>
	<field name="Unit_Price-price_unit" class="java.lang.Number">
		<fieldDescription><![CDATA[Invoice_Lines-invoice_line/Unit_Price-price_unit]]></fieldDescription>
	</field>
	<field name="Additional_Disc_Amt-add_disc_amt" class="java.lang.Number">
		<fieldDescription><![CDATA[Additional_Disc_Amt-add_disc_amt]]></fieldDescription>
	</field>
	<field name="Internal_Reference-default_code" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Lines-invoice_line/Product-product_id/Internal_Reference-default_code]]></fieldDescription>
	</field>
	<field name="Country-country_id" class="java.lang.String">
		<fieldDescription><![CDATA[Partner-partner_id/Country-country_id]]></fieldDescription>
	</field>
	<field name="id" class="java.lang.String">
		<fieldDescription><![CDATA[id]]></fieldDescription>
	</field>
	<field name="Invoice_Reference-reference" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Reference-reference]]></fieldDescription>
	</field>
	<field name="Street-street" class="java.lang.String">
		<fieldDescription><![CDATA[Partner-partner_id/Street-street]]></fieldDescription>
	</field>
	<field name="Tax-amount_tax" class="java.lang.Number">
		<fieldDescription><![CDATA[Tax-amount_tax]]></fieldDescription>
	</field>
	<field name="Name-name" class="java.lang.String">
		<fieldDescription><![CDATA[Partner-partner_id/Name-name]]></fieldDescription>
	</field>
	<field name="Additional_Discount-add_disc" class="java.lang.Number">
		<fieldDescription><![CDATA[Additional_Discount-add_disc]]></fieldDescription>
	</field>
	<field name="Invoice_Date-date_invoice" class="java.sql.Timestamp">
		<fieldDescription><![CDATA[Invoice_Date-date_invoice]]></fieldDescription>
	</field>
	<field name="Number-number" class="java.lang.String">
		<fieldDescription><![CDATA[Number-number]]></fieldDescription>
	</field>
	<field name="Salesperson-user_id" class="java.lang.String">
		<fieldDescription><![CDATA[Salesperson-user_id]]></fieldDescription>
	</field>
	<field name="Untaxed-amount_untaxed" class="java.lang.Number">
		<fieldDescription><![CDATA[Untaxed-amount_untaxed]]></fieldDescription>
	</field>
	<field name="Name-name3" class="java.lang.String">
		<fieldDescription><![CDATA[Salesperson-user_id/Related_Partner-partner_id/Name-name]]></fieldDescription>
	</field>
	<field name="City-city" class="java.lang.String">
		<fieldDescription><![CDATA[Partner-partner_id/City-city]]></fieldDescription>
	</field>
	<field name="Source_Document-origin" class="java.lang.String">
		<fieldDescription><![CDATA[Source_Document-origin]]></fieldDescription>
	</field>
	<field name="Country_Name-name" class="java.lang.String">
		<fieldDescription><![CDATA[Partner-partner_id/Country-country_id/Country_Name-name]]></fieldDescription>
	</field>
	<field name="Subtotal-price_subtotal" class="java.lang.Number">
		<fieldDescription><![CDATA[Invoice_Lines-invoice_line/Subtotal-price_subtotal]]></fieldDescription>
	</field>
	<field name="Quantity-quantity" class="java.lang.Number">
		<fieldDescription><![CDATA[Invoice_Lines-invoice_line/Quantity-quantity]]></fieldDescription>
	</field>
	<field name="Unit_of_Measure-name" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Lines-invoice_line/Unit_of_Measure-uos_id/Unit_of_Measure-name]]></fieldDescription>
	</field>
	<field name="State-state_id" class="java.lang.String">
		<fieldDescription><![CDATA[Partner-partner_id/State-state_id]]></fieldDescription>
	</field>
	<field name="Payment_Term-name" class="java.lang.String">
		<fieldDescription><![CDATA[Partner-partner_id/Customer_Payment_Term-property_payment_term/Payment_Term-name]]></fieldDescription>
	</field>
	<field name="Street2-street2" class="java.lang.String">
		<fieldDescription><![CDATA[Partner-partner_id/Street2-street2]]></fieldDescription>
	</field>
	<field name="Discount-discount" class="java.lang.Float">
		<fieldDescription><![CDATA[Invoice_Lines-invoice_line/Discount-discount]]></fieldDescription>
	</field>
	<field name="desc" class="java.lang.String">
		<fieldDescription><![CDATA[invoice_line/name]]></fieldDescription>
	</field>
	<field name="Product-product_id" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Lines-invoice_line/Product-product_id]]></fieldDescription>
	</field>
	<field name="Status-state" class="java.lang.String">
		<fieldDescription><![CDATA[Status-state]]></fieldDescription>
	</field>
	<field name="Zip-zip" class="java.lang.String">
		<fieldDescription><![CDATA[Partner-partner_id/Zip-zip]]></fieldDescription>
	</field>
	<field name="Net_Amount-amount_net" class="java.lang.Number">
		<fieldDescription><![CDATA[Net_Amount-amount_net]]></fieldDescription>
	</field>
	<field name="Name-name4" class="java.lang.String">
		<fieldDescription><![CDATA[Modified_By-write_uid/Name-name]]></fieldDescription>
	</field>
	<field name="MH_Internal_No.-number_mh" class="java.lang.Integer">
		<fieldDescription><![CDATA[MH_Internal_No.-number_mh]]></fieldDescription>
	</field>
	<field name="MH_No.-number_mh_safe" class="java.lang.String">
		<fieldDescription><![CDATA[MH_No.-number_mh_safe]]></fieldDescription>
	</field>
	<field name="Name-name5" class="java.lang.String">
		<fieldDescription><![CDATA[Shipper-shipper_id/Name-name]]></fieldDescription>
	</field>
	<field name="Additional_Information-comment" class="java.lang.String">
		<fieldDescription><![CDATA[Additional_Information-comment]]></fieldDescription>
	</field>
	<field name="Due_Date-date_due" class="java.sql.Timestamp">
		<fieldDescription><![CDATA[Due_Date-date_due]]></fieldDescription>
	</field>
	<field name="Name-name6" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Address-partner_invoice_id/Name-name]]></fieldDescription>
	</field>
	<field name="Street-street2" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Address-partner_invoice_id/Street-street]]></fieldDescription>
	</field>
	<field name="Street2-street22" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Address-partner_invoice_id/Street2-street2]]></fieldDescription>
	</field>
	<field name="Zip-zip2" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Address-partner_invoice_id/Zip-zip]]></fieldDescription>
	</field>
	<field name="Country_Name-name2" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Address-partner_invoice_id/Country-country_id/Country_Name-name]]></fieldDescription>
	</field>
	<field name="City-city2" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Address-partner_invoice_id/City-city]]></fieldDescription>
	</field>
	<field name="State-state_id2" class="java.lang.String">
		<fieldDescription><![CDATA[Invoice_Address-partner_invoice_id/State-state_id]]></fieldDescription>
	</field>
	<field name="payment_term" class="java.lang.String">
		<fieldDescription><![CDATA[payment_term/name]]></fieldDescription>
	</field>
	<field name="default_code" class="java.lang.String">
		<fieldDescription><![CDATA[invoice_line/product_id/default_code]]></fieldDescription>
	</field>
	<field name="main_code" class="java.lang.String">
		<fieldDescription><![CDATA[invoice_line/product_id/product_main_code]]></fieldDescription>
	</field>
	<field name="remarks" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/remarks]]></fieldDescription>
	</field>
	<variable name="string_total" class="java.lang.String">
		<variableExpression><![CDATA[(Math.round($F{Total-amount_total}*100)/100).toString()]]></variableExpression>
	</variable>
	<group name="UniqueID" isStartNewPage="true" footerPosition="ForceAtBottom">
		<groupExpression><![CDATA[$F{id}]]></groupExpression>
		<groupFooter>
			<band/>
		</groupFooter>
	</group>
	<background>
		<band height="752">
			<textField isBlankWhenNull="true">
				<reportElement x="152" y="335" width="327" height="70" forecolor="#000000"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="30" isBold="true" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{Status-state} == "cancel" ? "ยกเลิก" : ""]]></textFieldExpression>
			</textField>
		</band>
	</background>
	<pageHeader>
		<band height="205" splitType="Stretch">
			<textField>
				<reportElement x="454" y="83" width="82" height="15"/>
				<textElement>
					<font fontName="Monospaced" size="10" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{MH_No.-number_mh_safe}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="68" y="81" width="400" height="15"/>
				<textElement>
					<font fontName="Monospaced" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{Name-name6} != "" ? $F{Name-name6} : $F{Name-name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="68" y="108" width="277" height="49"/>
				<textElement>
					<font fontName="Monospaced" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{Name-name6} != "" ?
(new Scriptlet()).getAddress($F{Street-street2},$F{Street2-street22},
    $F{City-city2},$F{State-state_id2},$F{Country_Name-name2},$F{Zip-zip2}) :
(new Scriptlet()).getAddress($F{Street-street},$F{Street2-street2},
    $F{City-city},$F{State-state_id},$F{Country_Name-name},$F{Zip-zip})]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="454" y="108" width="96" height="15"/>
				<textElement>
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{Invoice_Date-date_invoice}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="419" y="157" width="77" height="15"/>
				<textElement>
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["กำหนดชำระเงิน"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="454" y="132" width="106" height="15"/>
				<textElement>
					<font fontName="Monospaced" size="10" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{Name-name3}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="504" y="157" width="76" height="15"/>
				<textElement>
					<font fontName="Monospaced" size="10" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{payment_term}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="239" y="38" width="106" height="23"/>
				<textElement textAlignment="Center">
					<font fontName="Monospaced" size="16" isBold="true" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["ใบยืมสินค้า"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="68" y="159" width="277" height="46"/>
				<textElement>
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{Name-name5}.toString() + " " + $F{Additional_Information-comment}.toString()]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="434" y="38" width="148" height="23" forecolor="#000000"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
					<font fontName="Monospaced" size="14" isBold="true" pdfFontName="Garuda-Bold.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{Status-state} == "cancel" ? "Cancelled" : ""]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="36" splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField pattern="#,##0.00;(-#,##0.00)" isBlankWhenNull="true">
				<reportElement x="357" y="0" width="99" height="20"/>
				<textElement textAlignment="Right">
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{Unit_Price-price_unit}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0;(-#,##0)">
				<reportElement x="0" y="0" width="65" height="20">
					<printWhenExpression><![CDATA[$F{Quantity-quantity} % 1 == 0]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right">
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{Quantity-quantity}]]></textFieldExpression>
			</textField>
			<textField pattern="">
				<reportElement x="65" y="0" width="31" height="20"/>
				<textElement>
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{Unit_of_Measure-name}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(-#,##0.00)" isBlankWhenNull="true">
				<reportElement x="507" y="0" width="75" height="20"/>
				<textElement textAlignment="Right">
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{Subtotal-price_subtotal}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(-#,##0.00)" isBlankWhenNull="true">
				<reportElement x="496" y="2" width="25" height="15">
					<printWhenExpression><![CDATA[$F{Discount-discount}.toString() != ""]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font size="6" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["(" + (new DecimalFormat("#.##")).format($F{Discount-discount}) + "%)"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(-#,##0.00)" isBlankWhenNull="true">
				<reportElement x="457" y="0" width="40" height="20"/>
				<textElement textAlignment="Right">
					<font size="10" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[($F{Discount-discount}/100) * $F{Quantity-quantity} * $F{Unit_Price-price_unit}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement x="96" y="0" width="301" height="20" isPrintWhenDetailOverflows="true"/>
				<textElement>
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{desc}.replace($F{default_code},"").replace("[]","").trim() + " ["+$F{main_code}+"]"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(-#,##0.00)">
				<reportElement x="0" y="0" width="65" height="20">
					<printWhenExpression><![CDATA[$F{Quantity-quantity} % 1 != 0]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right">
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{Quantity-quantity}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="168">
			<textField evaluationTime="Report">
				<reportElement x="560" y="148" width="40" height="20"/>
				<textElement>
					<font size="8" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="480" y="148" width="80" height="20"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER}+"/"]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<lastPageFooter>
		<band height="168">
			<textField isBlankWhenNull="true">
				<reportElement x="31" y="35" width="397" height="20"/>
				<textElement>
					<font fontName="Monospaced" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["("+(new Scriptlet()).getAmtInWords((new BigDecimal($V{string_total}==""?0:$V{string_total})).setScale(2).toString(),"THB")+")"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="428" y="73" width="152" height="15"/>
				<textElement textAlignment="Center">
					<font fontName="Monospaced" size="10" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{Name-name4}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(#,##0.00)" isBlankWhenNull="true">
				<reportElement x="439" y="30" width="141" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{Total-amount_total}.setScale(2, java.math.RoundingMode.HALF_UP)]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(#,##0.00)" isBlankWhenNull="true">
				<reportElement x="497" y="16" width="83" height="15">
					<printWhenExpression><![CDATA[$F{Tax-amount_tax} > 0]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{Tax-amount_tax}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="463" y="16" width="58" height="15">
					<printWhenExpression><![CDATA[$F{Tax-amount_tax} > 0]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right">
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Tax"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(#,##0.00)" isBlankWhenNull="true">
				<reportElement x="497" y="1" width="83" height="15">
					<printWhenExpression><![CDATA[$F{Tax-amount_tax} > 0]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{Net_Amount-amount_net}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="463" y="1" width="58" height="15">
					<printWhenExpression><![CDATA[$F{Tax-amount_tax} > 0]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right">
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Net"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="560" y="148" width="40" height="20"/>
				<textElement>
					<font size="8" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="480" y="148" width="80" height="20"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER}+"/"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement x="31" y="1" width="0" height="20" isPrintWhenDetailOverflows="true"/>
				<textElement>
					<font pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{remarks}]]></textFieldExpression>
			</textField>
		</band>
	</lastPageFooter>
</jasperReport>
